.XLIST
POSSIZE 	EQU	15
DICT_SIZE	EQU	32K-256
DICT_SIZE2	EQU	DICT_SIZE*2
MAX_MATCH	EQU	128
DICT_SIZE_MAX_MATCH	EQU	DICT_SIZE+MAX_MATCH
CHARSET_SIZE	EQU	256+MAX_MATCH+4 ;286

LIMITED_CHARSET EQU	0

SLR_FIX_BUFFERS EQU	256+MAX_MATCH
SLR_BLOCK_END   EQU     256+MAX_MATCH+1
SLR_EOF         EQU     256+MAX_MATCH+2

support2	EQU	-1

MAXBUF		EQU	65500
BUFBITS 	EQU	16
EXTRABITS	EQU	8
THRESHOLD	EQU	2
NTHRESHOLD	EQU	3
T2_BITS 	EQU	8
T2_LIMIT	EQU	256
HARD_CODED	EQU	8

POS_BITS	EQU	POSSIZE-HARD_CODED

HMB_SIZE	EQU	1K	;HUF MINI BUFFER SIZE
HPB_SIZE	EQU	1K	;HUF PUT BUFFER SIZE
HTW_SIZE	EQU	16K	;HASH TABLE WORDS
HTW2_SIZE	EQU	1K	;2-BYTE HASH TABLE SIZE

LENFIELD	EQU	4
MAXBITLEN	EQU	(1 SHL LENFIELD)
LEASTBIT	EQU	1 SHL (16-MAXBITLEN)

SLR_N_STRUCT	STRUC

SLR_NEXT	DW	?

SLR_N_STRUCT	ENDS

SLR_P_STRUCT	STRUC

SLR_PREV	DW	?

SLR_P_STRUCT	ENDS

SLR2_STRUCT	STRUC

SLR2_NEXT		DW	?
SLR2_PREV		DW	?
SLR2_VALUE		DW	?
SLR2_POSITION		DW	?

SLR2_STRUCT	ENDS

SLR_S1			STRUC

HASH_TABLE_OFFSET	DW	HTW_SIZE DUP(?)
HASH_TABLE2_OFFSET	DW	HTW2_SIZE DUP(?)
HUF_MINI_BUFFER 	DB	HMB_SIZE DUP(?)
SLR2_TABLE		DB	256 * SIZE SLR2_STRUCT DUP(?)

HUF_PUT_BUF		DB	HPB_SIZE DUP(?)
HUF_FREQ_CHAR		DW	CHARSET_SIZE*2 DUP(?)
HUF_FREQ_CHAR_LB	DB	CHARSET_SIZE*2 DUP(?)
HUF_LEFT_CHAR1		DW	CHARSET_SIZE DUP(?)
HUF_LEFT_CHAR		EQU	HUF_LEFT_CHAR1-CHARSET_SIZE*2
HUF_RIGHT_CHAR1 	DW	CHARSET_SIZE DUP(?)
HUF_RIGHT_CHAR		EQU	HUF_RIGHT_CHAR1-CHARSET_SIZE*2
HUF_CODEWORD_CHAR	DW	CHARSET_SIZE DUP(?)

HUF_CODEWORD_CHAR_LOW	EQU	(WORD PTR HUF_FREQ_CHAR_LB)

HUF_BITLEN_CHAR 	DW	CHARSET_SIZE DUP(?)
HUF_BITLEN_CHAR_OLD	DW	CHARSET_SIZE DUP(?)
HUF_FREQ_POS		DW	(1 SHL (POSSIZE-HARD_CODED))*2 DUP(?)
HUF_FREQ_POS_LB 	DB	(1 SHL (POSSIZE-HARD_CODED))*2 DUP(?)
HUF_LEFT_POS1		DW	(1 SHL (POSSIZE-HARD_CODED)) DUP(?)
HUF_LEFT_POS		EQU	HUF_LEFT_POS1-(1 SHL (POSSIZE-HARD_CODED))*2
HUF_RIGHT_POS1		DW	(1 SHL (POSSIZE-HARD_CODED)) DUP(?)
HUF_RIGHT_POS		EQU	HUF_RIGHT_POS1-(1 SHL (POSSIZE-HARD_CODED))*2
HUF_CODEWORD_POS	DW	(1 SHL (POSSIZE-HARD_CODED)) DUP(?)

HUF_CODEWORD_POS_LOW	EQU	(WORD PTR HUF_FREQ_POS_LB)

HUF_BITLEN_POS		DW	(1 SHL (POSSIZE-HARD_CODED)) DUP(?)
HUF_BITLEN_POS_OLD	DW	(1 SHL (POSSIZE-HARD_CODED)) DUP(?)
HUF_HEAP		DW	CHARSET_SIZE*2 DUP(?)

SLR_S1			ENDS

;HUF_CODEWORD_C 	EQU	HUF_LEFT_C
;HUF_BITLEN_C		EQU	HUF_RIGHT_C
;HUF_CODEWORD_P 	EQU	HUF_LEFT_P
;HUF_BITLEN_P		EQU	HUF_RIGHT_P

SLR_BUF 		EQU	BPTR 0

IF	0

C32_VARS		STRUC

;			DB	REUSABLE_BP DUP(?)

PUTSTUFF_SMALL_BP	DW	?
PUTSTUFF_BP		DW	?
SLR_FLUSHSTUFF_BP	DW	?
FIX_BUFFERS_BP		DW	?

COMPRESS_TABLE		EQU	PUTSTUFF_SMALL
COMPRESS_TABLE_LENGTH	EQU	$-PUTSTUFF_SMALL_BP

SLR_NEXT_SEG_BP 	DW	?
;SLR_PREV_SEG_BP 	DW	?
OLD_MATCHED_COUNT_BP	DW	?
OLD_OFFSET_BP		DW	?
NEXT_AVAIL_BP		DW	?
NEXT_AVAIL_2_BP 	DW	?
SLR_TMP_PTR_BP		DD	?
SLR_CPOS_BP		DW	?
HUF_AVAIL_BP		DW	?
HUF_SIZE_BP		DW	?
HUF_HEAP_START_BP	DW	?
HUF_HEAP_END_BP 	DW	?
SLR_DATA_BP		DW	?
SLR_VARS_BP		DW	?
SLR_BYTES_LEFT_BP	DD	?
HUF_TOTALS_BP		DD	?
SLR_INBUF_LIMIT_BP	DW	?
SLR_SCAN_LIMIT_BP	DW	?
SLR_INPUT_PTR_BP	DD	?
HUF_PUT_PTR_BP		DD	?
SLR_DICT_COUNT_BP	DW	?
SLR_DICT2_COUNT_BP	DW	?
DO_STUFF_LIMIT_BP	DW	?
HUF_MAKETREE_POS_FLAGS_BP DW	?
DEL_INST_COUNT_BP	DW	?

SLR_WORD_BP		DW	?
SLR_MASK_BP		DW	?

PUTBYTE_ADDR1_BP	DW	?
PUTBYTE_ADDR2_BP	DW	?
PUTBYTE_TEMP_BP 	DW	?

HUF_CODETEMP_LOW_BP	DW	?
HUF_TREESIZE_CHAR_BP	DW	?
HUF_TREESIZE_POS_BP	DW	?

C32_VARS		ENDS

DO	MACRO	X

X	EQU	(X&_BP[BP]-SIZE C32_VARS)

	ENDM

DO	PUTSTUFF_SMALL
DO	PUTSTUFF
DO	SLR_FLUSHSTUFF
DO	FIX_BUFFERS
DO	SLR_NEXT_SEG
;DO	SLR_PREV_SEG
DO	OLD_MATCHED_COUNT
DO	OLD_OFFSET
DO	NEXT_AVAIL
DO	NEXT_AVAIL_2
DO	SLR_TMP_PTR
DO	SLR_CPOS
DO	HUF_AVAIL
DO	HUF_SIZE
DO	HUF_HEAP_START
DO	HUF_HEAP_END
DO	SLR_DATA
DO	SLR_VARS
DO	SLR_BYTES_LEFT
DO	HUF_TOTALS
DO	SLR_INBUF_LIMIT
DO	SLR_SCAN_LIMIT
DO	SLR_INPUT_PTR
DO	HUF_PUT_PTR
DO	SLR_DICT_COUNT
DO	SLR_DICT2_COUNT
DO	DO_STUFF_LIMIT
DO	HUF_MAKETREE_POS_FLAGS
DO	DEL_INST_COUNT

DO	SLR_WORD
DO	SLR_MASK

DO	PUTBYTE_ADDR1
DO	PUTBYTE_ADDR2
DO	PUTBYTE_TEMP

DO	HUF_CODETEMP_LOW
DO	HUF_TREESIZE_CHAR
DO	HUF_TREESIZE_POS
ENDIF

.LIST

