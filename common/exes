.XLIST
OS2_SEGM_TYPE	EQU	1
WIN_SEGM_TYPE	EQU	2
DOS4_SEGM_TYPE	EQU	3
UNKNOWN_SEGM_TYPE	EQU	4
DOS_EXE_TYPE	EQU	5
PE_EXE_TYPE	EQU	6
DOSX_EXE_TYPE	EQU	7

MODEL_SMALL	EQU	1
MODEL_MEDIUM	EQU	2
MODEL_COMPACT	EQU	3
MODEL_LARGE	EQU	4
MODEL_HUGE	EQU	5
MODEL_DOSX	EQU	6
MODEL_FLATOS2	EQU	7
MODEL_FLATNT	EQU	8


EXE		STRUC
_EXE_SIGN		DW	?
_EXE_LEN_MOD_512	DW	?	;LENGTH OF EXE MOD 512
_EXE_LEN_PAGE_512	DW	?	;# OF 512 BYTE PAGES, INCLUDING HEADER
_EXE_N_RELOC		DW	?	;NUMBER OF RELOC ITEMS
_EXE_HDR_SIZE		DW	?	;# OF PARAGRAPHS IN HEADER
_EXE_MIN_ABOVE		DW	?	;MINIMUM ALLOCATION NEEDED ABOVE
_EXE_MAX_ABOVE		DW	?	;MAX ALLOCATION REQUEST
_EXE_REG_SS		DW	?	;STACK SEGMENT
_EXE_REG_SP		DW	?	;INITIAL SP VALUE
_EXE_CHKSUM		DW	?	;WORD CHECKSUM
_EXE_REG_IP		DW	?	;START ADDRESS OFFSET
_EXE_REG_CS		DW	?	;START ADDRESS SEGMENT
_EXE_RELOC_OFF		DW	?	;OFFSET TO RELOC ITEMS
_EXE_OVLY_NUM		DW	?	;OVERLAY NUMBER
if	any_overlays
_EXE_VECSEC_ADDR	DD	?
else
_EXE_?? 		DW	?	;SOMETHING FOR MS...
endif
_EXE_FIRST_RELOC	DD	?	;
_EXE_FILLER		DB	40H-$ DUP(?)

EXE		ENDS

NEXE		STRUC

_NEXE_SIGN		DW	?	;'NE'					00
_NEXE_LVERNUM		DW	?	;LINKER VERSION NUMBER			02
_NEXE_ENTRY_OFFSET	DW	?	;OFFSET TO ENTRY TABLE			04
_NEXE_ENTRY_LENGTH	DW	?	;BYTE-LENGTH OF ENTRY TABLE		06
_NEXE_CHECKSUM		DD	?	;FILE CHECKSUM				08
_NEXE_FLAGS		DW	?	;					0C
_NEXE_DGROUP		DW	?	;SEG NUMBER OF DGROUP			0E
_NEXE_HEAPSIZE		DW	?	;DYNAMIC HEAP				10
_NEXE_STACKSIZE 	DW	?	;					12
_NEXE_CSIP		DD	?	;START ADDRESS				14
_NEXE_SSSP		DD	?	;STACK					18
_NEXE_NSEGS		DW	?	;# OF SEGMENTS				1C
_NEXE_NMODS		DW	?	;# OF DLL'S REFERENCED			1E
_NEXE_NONRES_LENGTH	DW	?	;# OF BYTES IN NONRESIDENT NAME TABLE	20
_NEXE_SEGTBL_OFFSET	DW	?	;OFFSET TO SEGMENT TABLE		22
_NEXE_RSRCTBL_OFFSET	DW	?	;OFFSET TO RESOURCE TABLE		24
_NEXE_RESNAM_OFFSET	DW	?	;OFFSET TO RESIDENT NAMES TABLE		26
_NEXE_MODREF_OFFSET	DW	?	;OFFSET TO DLL REFERENCE TABLE		28
_NEXE_IMPNAM_OFFSET	DW	?	;					2A
_NEXE_NRESNAM_OFFSET	DD	?	;OFFSET (IN FILE) TO NONRESIDENT NAMES	2C
_NEXE_NMOVABLE_ENTS	DW	?	;# OF MOVABLE ENTRY POINTS		30
_NEXE_LSECTOR_SHIFT	DW	?	;					32
_NEXE_CRES		DW	?	;					34
_NEXE_EXETYPE		DB	?	;1 = OS/2, 2 = WINDOWS, 3 = DOS4	36
_NEXE_LONGNAMES_FLAG	DB	?	;1 = LONGNAMES		8 = gangload	37
_NEXE_GANGSTART		DW	?	;					38
_NEXE_GANGLENGTH	DW	?	;					3A
_NEXE_SWAPAREA		DW	?	;					3C
_NEXE_WINVER_FRAC	DB	?	;SUB-VERSION IN HUNDREDTHS (0AH == .1)	3E
_NEXE_WINVER_INT	DB	?	;REQUIRED WINDOWS VERSION		3F

NEXE		ENDS

PEXE		STRUC

_PEXE_SIGN		DW	?	;SHOULD BE 'PE/0/0'
			DW	?	;
_PEXE_CPU_REQUIRED	DW	?	;CPU COMPATIBILITY REQUIRED TO RUN
_PEXE_N_OBJECTS		DW	?	;# OF ENTRIES IN OBJECTS TABLE

_PEXE_TIME_DATE		DD	?	;LINK TIME AND DATE
_PEXE_RES1		DD	?	;PTR TO SYMBOL TABLE

_PEXE_RES2		DD	?	;# OF SYMBOLS
_PEXE_HDR_XTRA		DW	?	;# OF BYTES FOLLOWING FLAGS FIELD IN HEADER
_PEXE_FLAGS		DW	?	;PROGRAM, LIBRARY, LOADABLE, FIXED, ETC

_PEXE_MAJIC		DW	?	;MAGIC NUMBER
_PEXE_LMAJOR		DB	?	;LINKER MAJOR VERSION #
_PEXE_LMINOR		DB	?	;LINKER MINOR VERSION #
_PEXE_CODE_SIZE		DD	?	;SIZE OF FIRST CODE SECTION

_PEXE_IDATA_SIZE	DD	?	;INITIALIZED DATA SIZE
_PEXE_UDATA_SIZE	DD	?	;UNINITIALIZED DATA SIZE

_PEXE_ENTRY_RVA		DD	?	;START ADDRESS
_PEXE_CODE_BASE		DD	?	;ADDRESS OF BEGINNING OF CODE SECTION IN MEMORY

_PEXE_DATA_BASE		DD	?	;ADDRESS OF DATA SECTION IN MEMORY

_PEXE_IMAGE_BASE	DD	?	;VIRTUAL ADDRESS OF FIRST BYTE OF FILE, 64K MULTIPLE

_PEXE_OBJECT_ALIGN	DD	?	;POWER OF 2 BETWEEN 512 AND 256M.
_PEXE_FILE_ALIGN	DD	?	;POWER OF 2 BETWEEN 512 AND 64K.

_PEXE_OS_MAJOR		DW	1	;
_PEXE_OS_MINOR		DW	0	;
_PEXE_USER_MAJOR	DW	?	;
_PEXE_USER_MINOR	DW	?	;

_PEXE_SUBSYS_MAJOR	DW	?	;
_PEXE_SUBSYS_MINOR	DW	?	;
_PEXE_RES9		DD	?	;

_PEXE_IMAGE_SIZE	DD	?	;INCLUDING HEADERS, MULTIPLE OF OBJECT_ALIGN
_PEXE_HEADER_SIZE	DD	?	;DOS HEADER, PE HEADER, OBJECT TABLE

_PEXE_CHECKSUM		DD	?	;
_PEXE_SUBSYSTEM		DW	?	;NT, OS2, POSIX, ETC
_PEXE_DLL_FLAGS		DW	?	;INIT, TERM FLAGS

_PEXE_STACK_RESERVE	DD	?	;
_PEXE_STACK_COMMIT	DD	?	;

_PEXE_HEAP_RESERVE	DD	?	;
_PEXE_HEAP_COMMIT	DD	?	;

_PEXE_LOADER_FLAGS	DD	?	;
_PEXE_N_INTERESTING	DD	16	;# OF VA/SIZE ENTRIES THAT FOLLOW

_PEXE_EXPORT_RVA	DD	?	;
_PEXE_EXPORT_SIZE	DD	?	;

_PEXE_IMPORT_RVA	DD	?	;
_PEXE_IMPORT_SIZE	DD	?	;

_PEXE_RESOURCE_RVA	DD	?	;
_PEXE_RESOURCE_SIZE	DD	?	;

_PEXE_EXCEPTION_RVA	DD	?	;
_PEXE_EXCEPTION_SIZE	DD	?	;

_PEXE_SECURITY_RVA	DD	?	;
_PEXE_SECURITY_SIZE	DD	?	;

_PEXE_FIXUP_RVA		DD	?	;
_PEXE_FIXUP_SIZE	DD	?	;

_PEXE_DEBUG_RVA		DD	?	;
_PEXE_DEBUG_SIZE	DD	?	;

_PEXE_DESCRIPTION_RVA	DD	?	;
_PEXE_DESCRIPTION_SIZE	DD	?	;

_PEXE_MACHINE_RVA	DD	?	;
_PEXE_MACHINE_SIZE	DD	?	;

_PEXE_THREAD_LOCAL_RVA	DD	?	;
_PEXE_THREAD_LOCAL_SIZE	DD	?	;

_PEXE_LOAD_CONFIG_RVA	DD	?	;
_PEXE_LOAD_CONFIG_SIZE	DD	?	;

			DD	?	;
			DD	?	;

			DD	?	;
			DD	?	;

			DD	?	;
			DD	?	;

			DD	?	;
			DD	?	;

			DD	?	;
			DD	?	;

PEXE		ENDS


PEXE_UNKNOWN	EQU	0
PEXE_80386	EQU	014CH
PEXE_80486	EQU	014DH
PEXE_PENTIUM	EQU	014EH
PEXE_MARK1	EQU	0162H
PEXE_MARK2	EQU	0163H
PEXE_MARK3	EQU	0166H	;R4000	MIPS LITTLE-ENDIAN
PEXE_ALPHA	EQU	0184H	;ALPHA AXP

PEXE_PROGRAM	EQU	0
PEXE_EXECUTABLE	EQU	2
PEXE_FIXED	EQU	200H
PEXE_LIBRARY	EQU	2000H

PSUB_UNKNOWN	EQU	0
PSUB_NATIVE	EQU	1
PSUB_WIN_GUI	EQU	2
PSUB_WIN_CHAR	EQU	3
PSUB_OS2	EQU	5
PSUB_POSIX	EQU	7

PDLL_PPROC_INIT	EQU	1
PDLL_PPROC_TERM	EQU	2
PDLL_PTHRD_INIT	EQU	4
PDLL_PTHRD_TERM	EQU	8

PE_EXE_BASE	EQU	400000H
PE_DLL_BASE	EQU	10000000H

.LIST

